<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test align</title>
</head>
<body>
    <div>wa test lid</div>
    
    <script src="./build/wa_test.js"></script>
    <script src="./MatchParse.js"></script>
    <script>
        function createStr(inputString) {
            const stringLength = Module.lengthBytesUTF8(inputString) + 1; // ���� null ��ֹ��
            const mm = Module._create_buffer(stringLength);
            Module.stringToUTF8(inputString, mm, stringLength);
            return mm;
        }
        function batchFree(arr) {
            arr.forEach(a => Module._free_str_memory(a))
        }
        function tx() {
            const query = 'CAGCTGAGCTTTCCACCCAGCGCGGGTGCATTCTGGCTCTTATATATACTTATTGTCATGACAGAGTATATTGTACTGTAATT';
            const target = 'TACGGCAAGCTGACCCTGAAGTTCATCTGCACCACCGGCAAGCTGCCCGTGCCCTGGCCCACCCTCGTGACCATACTGTAATT';
            const a = createStr(query);
            const b = createStr(target);
            const matrix = createStr('blosum62');
            let res = Module._parasail_nw_wrap(a, b, matrix);
            const arrRes = new Int32Array(Module.HEAP32.buffer, res, 6);
            const matchItem = new MatchResult(arrRes, query, target);
            console.log(matchItem, 'match res');
            // console.log(arrRes, 'arr');
            // console.log('query:', Module.UTF8ToString(arrRes[0]));
            // console.log('align:', Module.UTF8ToString(arrRes[1]));
            // console.log('ref:', Module.UTF8ToString(arrRes[2]));
            // console.log("socre:", arrRes[3]);
            batchFree([res, a, b, matrix, arrRes]);

        }
    </script>
</body>
</html>

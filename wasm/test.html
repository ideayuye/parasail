<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test align</title>
</head>
<body>
    <div>wa test lid</div>
    <script src="./build/wa_test.js"></script>
    <script>
        function createStr(inputString) {
            const stringLength = Module.lengthBytesUTF8(inputString) + 1; // ���� null ��ֹ��
            const mm = Module._create_buffer(stringLength);
            Module.stringToUTF8(inputString, mm, stringLength);
            return mm;
        }
        function batchFree(arr) {
            arr.forEach(a => Module._free_str_memory(a))
        }
        function tx() {
            const inputString = 'CAGCTGAGCTTTCCACCCAGCGCGGGTGCATTCTGGCTCTTATATATACTTATTGTCATGACAGAGTATATTGTACTGTAATT';
            const inputString1 = 'TACGGCAAGCTGACCCTGAAGTTCATCTGCACCACCGGCAAGCTGCCCGTGCCCTGGCCCACCCTCGTGACCATACTGTAATT';
            const a = createStr(inputString);
            const b = createStr(inputString1);
            const matrix = createStr('blosum62');
            let res = Module._parasail_sw_wrap(a, b, matrix);
            const arrRes = new Int32Array(Module.HEAP32.buffer, res, 3);
            console.log(arrRes, 'arr');
            console.log('query:', Module.UTF8ToString(arrRes[0]));
            console.log('align:', Module.UTF8ToString(arrRes[1]));
            console.log('ref:', Module.UTF8ToString(arrRes[2]));
            batchFree([res, a, b, matrix, arrRes]);

        }
        function qs() {
            // 调用 createIntArray 获取整数数组的指针
            const intArrayPointer = Module._createIntArray()

            // 使用 HEAP32 读取整数数组的值
            const arrayLength = 5;
            const intArray = new Int32Array(Module.HEAP32.buffer, intArrayPointer, arrayLength);

            // 打印整数数组的值
            console.log("Int Array:", intArray);
        }
    </script>
</body>
</html>
